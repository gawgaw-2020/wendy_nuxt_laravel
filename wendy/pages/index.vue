<template>
  <div class="top">
    <div class="time-modal" v-show="timeModal">
      <div class="time-modal__inner animate__animated animate__fadeIn">
        <p class="time-modal__message">æ™‚é–“å¸¯ã‚’é¸æŠã—ã¦ãã ã•ã„</p>
        <p class="time-modal__item" @click="selectTime" data-time="é…ãƒ©ãƒ³ãƒ">é…ãƒ©ãƒ³ãƒ</p>
        <p class="time-modal__item" @click="selectTime" data-time="æ—©ãƒ‡ã‚£ãƒŠãƒ¼">æ—©ãƒ‡ã‚£ãƒŠãƒ¼</p>
        <p class="time-modal__item" @click="selectTime" data-time="é…ãƒ‡ã‚£ãƒŠãƒ¼">é…ãƒ‡ã‚£ãƒŠãƒ¼</p>
      </div>
      <div class="time-modal__background animate__animated animate__fadeIn" @click="timeModalToggle"></div>
    </div>
    <div class="area-modal" v-show="areaModal">
      <div class="area-modal__inner animate__animated animate__fadeIn">
        <p class="area-modal__message">ã‚¨ãƒªã‚¢ã‚’é¸æŠã—ã¦ãã ã•ã„</p>
        <p class="area-modal__item" @click="selectArea" data-area="æ–°å®¿ãƒ»ä»£ã€…æœ¨">æ–°å®¿ãƒ»ä»£ã€…æœ¨</p>
        <p class="area-modal__item" @click="selectArea" data-area="æ¸‹è°·ãƒ»åŸå®¿ãƒ»è¡¨å‚é“">æ¸‹è°·ãƒ»åŸå®¿ãƒ»è¡¨å‚é“</p>
        <p class="area-modal__item" @click="selectArea" data-area="æµæ¯”å¯¿ãƒ»ä»£å®˜å±±ãƒ»ç›®é»’">æµæ¯”å¯¿ãƒ»ä»£å®˜å±±ãƒ»ç›®é»’</p>
        <p class="area-modal__item" @click="selectArea" data-area="äº”åç”°ãƒ»å“å·">äº”åç”°ãƒ»å“å·</p>
        <p class="area-modal__item" @click="selectArea" data-area="å…­æœ¬æœ¨ãƒ»åºƒå°¾ãƒ»èµ¤å‚">å…­æœ¬æœ¨ãƒ»åºƒå°¾ãƒ»èµ¤å‚</p>
        <p class="area-modal__item" @click="selectArea" data-area="æµœæ¾ç”ºãƒ»ä¸‰ç”°ãƒ»ç”°ç”º">æµœæ¾ç”ºãƒ»ä¸‰ç”°ãƒ»ç”°ç”º</p>
        <p class="area-modal__item" @click="selectArea" data-area="æ–°æ©‹ãƒ»æœ‰æ¥½ç”ºãƒ»éŠ€åº§">æ–°æ©‹ãƒ»æœ‰æ¥½ç”ºãƒ»éŠ€åº§</p>
        <p class="area-modal__item" @click="selectArea" data-area="æ±äº¬ãƒ»æ—¥æœ¬æ©‹ãƒ»èŒ…å ´ç”º">æ±äº¬ãƒ»æ—¥æœ¬æ©‹ãƒ»èŒ…å ´ç”º</p>
        <p class="area-modal__item" @click="selectArea" data-area="æ± è¢‹ãƒ»ç›®ç™½ãƒ»é«˜ç”°é¦¬å ´">æ± è¢‹ãƒ»ç›®ç™½ãƒ»é«˜ç”°é¦¬å ´</p>
        <p class="area-modal__item" @click="selectArea" data-area="å››è°·ãƒ»ç¥æ¥½å‚ãƒ»é£¯ç”°æ©‹">å››è°·ãƒ»ç¥æ¥½å‚ãƒ»é£¯ç”°æ©‹</p>
        <p class="area-modal__item" @click="selectArea" data-area="ä¸Šé‡ãƒ»å¾¡å¾’ç”ºãƒ»æµ…è‰">ä¸Šé‡ãƒ»å¾¡å¾’ç”ºãƒ»æµ…è‰</p>
        <p class="area-modal__item" @click="selectArea" data-area="æ°´é“æ©‹ãƒ»ç¥ç”°ãƒ»ç§‹è‘‰åŸ">æ°´é“æ©‹ãƒ»ç¥ç”°ãƒ»ç§‹è‘‰åŸ</p>
        <p class="area-modal__item" @click="selectArea" data-area="ä¸­é‡ãƒ»å‰ç¥¥å¯ºãƒ»ä¸‰é·¹">ä¸­é‡ãƒ»å‰ç¥¥å¯ºãƒ»ä¸‰é·¹</p>
        <p class="area-modal__item" @click="selectArea" data-area="ãã®ä»–">ãã®ä»–</p>
      </div>
      <div class="area-modal__background animate__animated animate__fadeIn" @click="areaModalToggle"></div>
    </div>

    <div class="search-top">
      <div class="search-top__inner">
        <form class="search-top__container" action="#" method="#">
          <p><i class="search-top__icon fas fa-search"></i></p>
          <input
            class="search-top__search"
            type="text"
            placeholder="åº—èˆ—åãƒ»ã‚¨ãƒªã‚¢åãƒ»ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰"
          />
        </form>
      </div>
    </div>
    <div class="hero">
      <div class="hero__mask">
        <div class="hero__catch">
          <p class="hero__sub-title">When do you eat?</p>
          <p class="hero__title">ã„ã¤ã‚‚ã¨é•ã†æ™‚é–“ã§</p>
          <p class="hero__title">ã„ã¤ã‚‚ã‚ˆã‚ŠãŠå¾—ã«ãŠé£Ÿäº‹</p>
        </div>
      </div>
    </div>
    <SearchModal @timeModal='openTimeModal' @areaModal='openAreaModal' :selectedTime="this.selectedTime" :selectedArea="this.selectedArea"/>
    <div class="content">
      <div class="appeal">
        <p class="appeal__title">ï¼Šå…¨ã¦ã®ãŠåº—ã‚’ãƒã‚§ãƒƒã‚¯ã™ã‚‹ï¼Š</p>
        <p class="appeal__sub-title">ã©ã®ãŠåº—ã‚‚ãŠå¾—ãŒã„ã£ã±ã„ğŸ˜</p>
        <div class="appeal-stores">
          <ul class="appeal-stores__inner">
            <li class="mini-store-card" v-for="(article, index) in allArticles" :key="index">
              <nuxt-link :to="`/article/${article.store_id}`">
                <p class="mini-store-card__image"><img :src="article.main_image" alt=""></p>
                <p class="mini-store-card__title">{{ article.name }}</p>
              </nuxt-link>
            </li>
          </ul>
        </div>
        <p class="appeal__view-more"><nuxt-link :to="`/article/all-articles/`">ã‚‚ã£ã¨è¦‹ã‚‹ ï¼</nuxt-link></p>
      </div>
      <div class="appeal">
        <p class="appeal__title">é…ã„æ™‚é–“ã®ãƒ©ãƒ³ãƒã§ãŠå¾—ãªãŠåº—</p>
        <p class="appeal__sub-title">ä»Šæ—¥ã¯<span class="oso-lunch">é…ãƒ©ãƒ³ãƒ</span>ã§å…ƒæ°—ã‚’ãƒãƒ£ãƒ¼ã‚¸ğŸ´</p>
        <div class="appeal-stores">
          <ul class="appeal-stores__inner">
            <li class="mini-store-card" v-for="(article, index) in osoLunchArticles" :key="index">
              <nuxt-link :to="`/article/${article.store_id}`">
                <p class="mini-store-card__image"><img :src="article.main_image" alt=""></p>
                <p class="mini-store-card__title">{{ article.name }}</p>
              </nuxt-link>
            </li>
          </ul>
        </div>
        <p class="appeal__view-more"><nuxt-link :to="`/article/osoLunchArticles/?selectedTime=é…ãƒ©ãƒ³ãƒ`">ã‚‚ã£ã¨è¦‹ã‚‹ ï¼</nuxt-link></p>
      </div>
      <div class="appeal">
        <p class="appeal__title">æ—©ã‚ã®æ™©ã”ã¯ã‚“ã§ãŠå¾—ãªãŠåº—</p>
        <p class="appeal__sub-title">ä»Šæ—¥ã¯<span class="haya-dinner">æ—©ãƒ‡ã‚£ãƒŠãƒ¼</span>ã§ã‚†ã£ãŸã‚ŠãŠé£Ÿäº‹</p>
        <div class="appeal-stores">
          <ul class="appeal-stores__inner">
            <li class="mini-store-card" v-for="(article, index) in hayaDinnerArticles" :key="index">
              <nuxt-link :to="`/article/${article.store_id}`">
                <p class="mini-store-card__image"><img :src="article.main_image" alt=""></p>
                <p class="mini-store-card__title">{{ article.name }}</p>
              </nuxt-link>
            </li>
          </ul>
        </div>
        <p class="appeal__view-more"><nuxt-link :to="`/article/hayaDinnerArticles/?selectedTime=æ—©ãƒ‡ã‚£ãƒŠãƒ¼`">ã‚‚ã£ã¨è¦‹ã‚‹ ï¼</nuxt-link></p>
      </div>
      <div class="appeal">
        <p class="appeal__title">é…ã„æ™‚é–“ã®å…¥åº—ã§ãŠå¾—ãªãŠåº—</p>
        <p class="appeal__sub-title">å®Ÿã¯<span class="oso-dinner">é…ãƒ‡ã‚£ãƒŠãƒ¼</span>ã‚‚ãŠå¾—ãŒã„ã£ã±ã„ğŸŒ™</p>
        <div class="appeal-stores">
          <ul class="appeal-stores__inner">
            <li class="mini-store-card" v-for="(article, index) in osoDinnerArticles" :key="index">
              <nuxt-link :to="`/article/${article.store_id}`">
                <p class="mini-store-card__image"><img :src="article.main_image" alt=""></p>
                <p class="mini-store-card__title">{{ article.name }}</p>
              </nuxt-link>
            </li>
          </ul>
        </div>
        <p class="appeal__view-more"><nuxt-link :to="`/article/osoDinnerArticles/?selectedTime=é…ãƒ‡ã‚£ãƒŠãƒ¼`">ã‚‚ã£ã¨è¦‹ã‚‹ ï¼</nuxt-link></p>
      </div>
      <div class="appeal">
        <p class="appeal__view-more"><nuxt-link :to="`/add_article_data/`">ç®¡ç†ç”¨ãƒªãƒ³ã‚¯ ï¼</nuxt-link></p>
      </div>
    </div>
  </div>
</template>

<script>
import { mapGetters, mapActions } from "vuex";

export default {
  data() {
    return {
      timeModal: false,
      areaModal: false,
      selectedTime: 'æ—©ãƒ‡ã‚£ãƒŠãƒ¼',
      selectedArea: 'æ±äº¬ãƒ»æ—¥æœ¬æ©‹ãƒ»èŒ…å ´ç”º',
    };
  },
  computed: {
    ...mapGetters('articles', ['allArticles', 'osoLunchArticles', 'hayaDinnerArticles', 'osoDinnerArticles'])
  },
  methods: {
    ...mapActions('articles', ['getAllArticles', 'getOsoLunchArticles', 'getHayaDinnerArticles', 'getOsoDinnerArticles']),
    toggleFixedBackground() {
      if(document.body.style.overflow === '') {
        document.body.style.overflow = 'hidden';
      } else {
        document.body.style.overflow = '';
      }
    },
    areaModalMoveToTop() {
      const obj = document.querySelector('.area-modal__inner');
      obj.scrollTop = 0
    },
    timeModalToggle() {
      this.timeModal = !this.timeModal
      this.toggleFixedBackground()
    },
    areaModalToggle() {
      this.areaModal = !this.areaModal
      this.toggleFixedBackground()
      this.areaModalMoveToTop()
    },
    openTimeModal(payload) {
      this.timeModal = payload
      this.toggleFixedBackground()

    },
    openAreaModal(payload) {
      this.areaModal = payload
      this.toggleFixedBackground()
    },
    selectTime(e) {
      this.selectedTime = e.currentTarget.getAttribute('data-time')
      this.timeModal = !this.timeModal
      this.toggleFixedBackground()
    },
    selectArea(e) {
      this.selectedArea = e.currentTarget.getAttribute('data-area')
      this.areaModal = !this.areaModal
      this.toggleFixedBackground()
      this.areaModalMoveToTop()
    }
  },
  created: function () {
    this.getAllArticles()
    this.getOsoLunchArticles()
    this.getHayaDinnerArticles()
    this.getOsoDinnerArticles()
  },
};
</script>

<style lang="scss" scoped>
.time-modal {
  text-align: center;
  color: #fff;
  &__inner{
    max-width: 768px;
    overflow: scroll;
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 85%;
    background: transparent linear-gradient(180deg, #ff427a 0%, #EAE5E6 300%) 0% 0% no-repeat padding-box;
    opacity: 1;
    z-index: 10000;
    border-radius: 20px;
    @include mq() {
      top: 40%;
    }
  }
  &__background{
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0,0,0,.8);
    z-index: 9999;
    cursor: pointer;
  }
  &__message {
    font-size: 1.4rem;
    padding: 1.4rem 0;
  }
  &__item {
    border-top: 1px solid #bbb;
    padding: 1.5rem 0;
    font-weight: bold;
  }
}
.area-modal {
  text-align: center;
  color: #fff;
  &__inner{
    max-width: 768px;
    overflow: scroll;
    position: fixed;
    top: 45%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 85%;
    background: transparent linear-gradient(180deg, #ff427a 0%, #EAE5E6 300%) 0% 0% no-repeat padding-box;
    opacity: 1;
    z-index: 10000;
    border-radius: 20px;
    max-height: 435px;
  }
  &__background{
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0,0,0,.8);
    z-index: 9999;
    cursor: pointer;
  }
  &__message {
    font-size: 1.4rem;
    padding: 1.4rem 0;
    background: #ff427a;
    position: sticky;
    top: 0;
    width: 100%;
  }
  &__item {
    font-size: 1.6rem;
    border-top: 1px solid #bbb;
    padding: 1rem 0;
    font-weight: bold;
  }

}

.test {
  font-size: 1.6rem;
  line-height: 2;
  background-color: #ddd;
}

.top {
  position: relative;
}

.search-top {
  padding-bottom: 0.8rem;
  &__inner {
    max-width: 1366px;
    padding: 0 16px;
    margin: 0 auto;
    position: relative;
  }
  &__icon {
    font-size: 2.4rem;
    position: absolute;
    color: #aaa;
    top: 6px;
    left: 35px;
  }
  &__search {
    font-size: 1.4rem;
    width: 100%;
    height: 36px;
    padding: 0 0 0 6rem;
    background-color: #efefef;
    border: none;
    border-radius: 18px;
  }
  &__search::placeholder {
    color: #aaa;
  }
  &__search:focus {
    outline: none;
  }
}

.hero {
  background-image: url('/img/hero.png');
  background-size: cover;
  background-position: center;
  height: 320px;
  &__mask {
    background-color: rgba(56, 56, 56, 0.4);
    height: 100%;
    position: relative;
  }
  &__catch {
    width: 100%;
    color: #fff;
    font-weight: bold;
    text-align: center;
    position: absolute;
    top: 37%;
    left: 50%;
    transform: translate(-50%, -50%);
  }
  &__sub-title {
    font-size: 1.2rem;
    margin-bottom: 1.2rem;
  }
  &__title {
    font-size: 2.1rem;
  }
}

.content {
  padding-top: 10rem;
  padding-bottom: 8.8rem;
}

.appeal {
  margin-bottom: 2.2rem;
  padding-left: 1.6rem;
  &__title {
    font-size: 1.6rem;
    margin-bottom: 0.4rem;
  }
  &__sub-title {
    font-weight: bold;
    font-size: 1.2rem;
    margin-bottom: 1.2rem;
    .oso-lunch {
      color: rgb(72, 179, 245);
    }
    .haya-dinner {
      color: rgba(236, 103, 63, 1);
    }
    .oso-dinner {
      color: rgba(66, 58, 141, 1);
    }
  }
  .appeal-stores {
    &__inner {
      overflow-x: auto;
      white-space: nowrap;
      margin-bottom: 1rem;
    }
  }
  .mini-store-card {
    display: inline-block;
    margin-right: 2rem;
    &__image {
      width: 140px;
      max-height: 90px;
      overflow: hidden;
      margin-bottom: 0.4rem;
      @include mq() { // å¼•æ•°ã‚’å€‹åˆ¥ã«æŒ‡å®š
        width: 280px;
        max-height: 180px;
      }
    }
    &__image img {
      border-radius: 5px;
    }
    &__title {
      width: 140px;
      @include mq() { // å¼•æ•°ã‚’å€‹åˆ¥ã«æŒ‡å®š
        width: 280px;
      }
      font-size: 1.4rem;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
  }
  &__view-more {
    display: block;
    font-size: 1.4rem;
    text-align: right;
    padding-right: 2rem;
    cursor: pointer;
    a {
      color: #2e6171;
    }
  }
}

</style>
